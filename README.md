# claude-kit

Shared Claude Code configuration for [beekeeper-lab](https://github.com/beekeeper-lab) projects.

## What's in the kit

| Directory | Contents |
|-----------|----------|
| `agents/` | AI persona definitions (Team Lead, Architect, Developer, Tech QA, BA) |
| `commands/` | Slash command definitions (bug, feature, chore, deploy, etc.) |
| `hooks/` | Safety hooks and policy enforcement (bash_safety, write_safety, telemetry) |
| `skills/` | Invokable workflow automations with SKILL.md definitions |
| `scripts/` | Sync script and git hooks |
| `settings.json` | Base Claude Code settings (hooks, MCP servers) |
| `CLAUDE.md` | Shared project instructions imported by every project |

## How it works

Each project includes this repo as a git submodule at `.claude/shared/`. A sync script generates the Claude Code discovery layer (`.claude/{commands,skills,agents,hooks}/`) by symlinking content from both shared (this repo) and local (project-specific) sources.

```
project/.claude/
  shared/           ← this repo (git submodule)
  local/            ← project-specific assets
  commands/         ← generated symlinks (gitignored)
  skills/           ← generated symlinks (gitignored)
  agents/           ← generated symlinks (gitignored)
  hooks/            ← generated symlinks (gitignored)
  settings.json     ← generated by merging shared + local (gitignored)
```

## Setup (new project)

```bash
# Add the submodule
git submodule add git@github.com:beekeeper-lab/claude-kit.git .claude/shared

# Create local directories
mkdir -p .claude/local/{agents,commands,hooks,skills}

# Create thin wrapper script
mkdir -p scripts
cat > scripts/claude-sync.sh << 'WRAPPER'
#!/usr/bin/env bash
exec "$(git rev-parse --show-toplevel)/.claude/shared/scripts/claude-sync.sh" "$@"
WRAPPER
chmod +x scripts/claude-sync.sh

# Run initial sync
scripts/claude-sync.sh

# Add gitignore entries for generated layer
cat >> .gitignore << 'IGNORE'

# Claude-Kit: generated layer (recreated by scripts/claude-sync.sh)
.claude/agents/
.claude/commands/
.claude/skills/
.claude/hooks/
.claude/settings.json
.claude/mcp.json
IGNORE
```

## Setup (existing clone)

```bash
git submodule update --init --recursive
scripts/claude-sync.sh
```

## Adding project-specific content

Place files in `.claude/local/`:
- `.claude/local/commands/my-command.md` — project-specific command
- `.claude/local/agents/my-agent.md` — project-specific agent
- `.claude/local/settings.json` — project-specific settings (deep-merged with shared)
- `.claude/local/mcp.json` — project-specific MCP servers (symlinked)

Local assets override shared assets when both have the same filename.

## Publishing changes (foundry only)

Only the foundry project pushes changes to this repo:

```bash
cd .claude/shared
git checkout -b feat/my-change
# make changes
git add -A && git commit -m "description"
git push -u origin feat/my-change
# create PR, get review, merge
```
